{% extends "store/base.html" %}
{% load static %}

{% block content %}
<div class="container mt-5 bg-primary">
    <h2 class="mb-4">ğŸ“‹ Administrare Comenzi</h2>

    {% if messages %}
        {% for message in messages %}
            <div class="alert alert-{{ message.tags }}">{{ message }}</div>
        {% endfor %}
    {% endif %}

    {% for order in orders %}
        <br><br>
        <div class="order-card">
            <div class="order-id"><h1> Comanda #{{ order.id }}</h1> - <strong>{{ order.order_status }}</strong></div>
            <div>ğŸ‘¤ Client: {{ order.full_name }} ({{ order.email }})</div>
            <div>ğŸ“¦ AdresÄƒ: {{ order.shipping_address }}</div>
            <div>ğŸ“… Data: {{ order.date_odered }}</div>
            <div class="order-total mt-2">ğŸ’° Total: {{ order.amount_paid }} LEI</div>

            <h6 class="mt-3">ğŸ›ï¸ Produse:</h6>
            {% for item in order.orderitem_set.all %}
                <div class="order-product">â€¢ {{ item.product.title }} x{{ item.quantity }}</div>
            {% endfor %}

            <!-- Form actualizare status -->
            <form method="POST" class="mt-3 d-inline">
                {% csrf_token %}
                <input type="hidden" name="order_id" value="{{ order.id }}">
                <select name="order_status" class="form-select d-inline w-auto me-2">
                    {% for status in status_choices %}
                        <option value="{{ status }}" {% if order.order_status == status %}selected{% endif %}>{{ status }}</option>
                    {% endfor %}
                </select>
                <button class="btn btn-primary btn-sm">ActualizeazÄƒ</button>
            </form>

            <!-- Form È™tergere comandÄƒ -->
            <form method="POST" action="{% url 'delete-order' order.id %}" class="d-inline ms-2">
                {% csrf_token %}
                <button type="submit" class="btn btn-danger btn-sm" onclick="return confirm('EÈ™ti sigur cÄƒ vrei sÄƒ È™tergi aceastÄƒ comandÄƒ?')">
                    ğŸ—‘ï¸ È˜terge
                </button>
            </form>
        </div>
    {% endfor %}
</div>
{% endblock %}
